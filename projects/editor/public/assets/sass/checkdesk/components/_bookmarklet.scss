// # Checkdesk Bookmarklet
// 
// First we configure the bookmarklet with variables that are not used anywhere else in the site, so are included in this file instead of config.rb.
$spinner-width: 25px;
$bookmarklet-width: 365px;
$bookmarklet-preview-max-height: 345px;
$bookmarklet-height: $bookmarklet-width + $bookmarklet-width * 0.61803;
$bookmarklet-font-size: 14px;

// ## Bookmarklet forms
// 
// TODO: this could be an extend, since it has no parameters.
@mixin bookmarklet-forms {
  form {
    @include reset-box-model;
  }
  .form-item {
    @include reset-box-model;
    float: $from-direction;
    clear: both;
    .description {
      width: $bookmarklet-width - 25px;
    }
  }
  .fb-message .description {
    display: none;
  }
  .field-type-link-field {
    clear: both;
    label {
      display: none;
      // HACK hidden labels
   
    }
  }
  .field-edit-link {
    display: none;
    // HACK hidden
 
  }
  .link-field-url {
    input[type=text],
    input[type=password],
    textarea {
      @include border-radius($radius);
    }
    input[type=text] {
      padding-#{opposite-position($from-direction)}: $spinner-width;
    }
  }
  textarea {
    height: 60px;
    padding: 5px;
  }
  .form-actions {
    @include reset-box-model;
    background: transparent;
    float: $from-direction;
    width: auto;
    border-top: 0;
    margin-top: 10px;
  }
  .footer {
    float: $from-direction;
    clear: both;
    margin-top: $gutter-width;
    input {
      @include button;
    }
  }
}

@mixin bookmarklet-step-one {
  h2 {
    @include reset-box-model;
    color: $grey;
    font-size: $base-font-size;
    float: $from-direction;
    margin: $absolute-line-height / 2 0 0 0;
    line-height: $absolute-line-height;
  }
  #meedan_bookmarklet_help {
    padding-top: $absolute-line-height / 2;
    line-height: $absolute-line-height;
    span {
      display: block;
      float: $from-direction;
      width: 30px;
      text-indent: -5000em;
      background: transparent url("../imgs/icons/bookmarklet-help.png") center center no-repeat;
      cursor: help;
      p {
        display: none;
      }
      &:hover p {
        display: block;
        width: 240px;
        height: auto;
        background: $white;
        border: 1px solid $gray-lighter;
        font-size: $small-font-size;
        line-height: 1.2;
        color: $gray-light;
        text-indent: 0;
        padding: $gutter-width;
        position: absolute;
        #{opposite-position($from-direction)}: 1px;
      }
    }
  }
  // Loading ..
  .meedan-bookmarklet-loading {
    background: $white url("../imgs/icons/bookmarklet-loading.gif") opposite-position($from-direction) center no-repeat;
  }
}

// Step two  ...
@mixin bookmarklet-step-two {
  #meedan_bookmarklet_preview {
    clear: both;
    color: $firefly60;
    margin: $gutter-width 0;
  }
  #meedan_bookmarklet_preview_content img {
    width: auto;
    clear: both;
  }
  .bookmarklet-preview {
    width: 100%;
  }
  #meedan_bookmarklet_preview_content,
  #meedan_bookmarklet_preview_gc {
    height: auto;
    width: 100%;
    max-height: $bookmarklet-preview-max-height;
    display: inline-block;
    overflow: hidden;
  }
  #meedan_bookmarklet_preview_gc {
    background: $grey;
    color: $firefly60;
    padding-top: 85px;
    height: $bookmarklet-preview-max-height;
    max-height: 145px;
    span,
    a {
      text-align: center;
      display: block;
      width: 100%;
    }
    span {
      font-size: 15px;
      margin-bottom: 5px;
    }
    a,
    a:visited,
    a:link,
    a:hover {
      text-decoration: none;
      color: #fff;
      font-weight: bold;
    }
  }
  .fb-status-preview {
    background: $firefly30;
    padding: $gutter-width;
    @include border-radius($radius);
    .author {
      float: right;
      clear: both;
    }
  }
  #edit-body {
    float: $from-direction;
    clear: both;
    margin-top: 0;
  }
  #edit-graphic-content {
    float: opposite-position($from-direction);
    margin: 0;
    margin-top: $gutter-width;
    width: auto;
    & > .form-type-checkbox {
      width: 100%;
    }
    .form-item label,
    .form-item input[type="checkbox"] {
      // padding: $gutter-width 2px; // pad for the hover
      &:hover {
        color: $identity;
      }
    }
  }
}

// Alerts in bookmarklet
@mixin bookmarklet-alerts {
  // Error messages
  .messages.error {
    clear: both;
    background: transparent;
    padding: 0;
    border: 0;
    color: #a00;
  }
  #meedan_bookmarklet_messages {
    padding: 0;
    margin: $absolute-line-height 0 0 0;
    clear: both;
    text-align: center;
    li {
      display: block;
      list-style: none;
      width: 100%;
      text-align: center;
      font-size: $small-font-size;
      margin-top: $gutter-width;
    }
    a {
      text-decoration: underline;
    }
    .meedan-bookmarklet-success {
      display: block;
      color: $white;
      padding: $gutter-width;
      background-color: rgba(0, 140, 0, 0.8);
    }
  }
}

// Login
@mixin bookmarklet-login {
  #user-login {
    label,
    input[type=text],
    input[type=password],
    a {
      clear: both;
    }
    ul {
      margin: 0;
    }
    li {
      list-style: none;
      display: block;
      margin: 0;
    }
    .messages.error {
      position: static;
      font-size: $bookmarklet-font-size;
      margin-bottom: $absolute-line-height / 3;
    }
    #edit-social-media-signin {
      margin-top: $absolute-line-height / 2;
      .item-list li a {
        padding: $absolute-line-height / 3 $gutter-width;
      }
    }
    .or {
      margin: 0 0;
    }
    .user-links {
      clear: both;
      font-size: $bookmarklet-font-size;
      padding-#{$omega}: $gutter-width;
    }
    .form-item-remember-me {
      clear: none;
      label {
        font-size: $bookmarklet-font-size;
      }
    }
    .user-new-account-link {
      .register {
        text-align: $omega;
        font-size: $bookmarklet-font-size;
      }
    }
    // username/pass field widths
    input[type=text],
    input[type=password] {
      padding-#{$omega}: 0;
    }
    .form-actions {
      margin-top: $absolute-line-height / 2;
    }
  }
}

// Internal bookmarklet (Submit Report link)
#nav-media-form {
  width: $bookmarklet-width;
  overflow-y: scroll;
  z-index: $z-index-dropdown;
  iframe {
    width: 100%;
  }
}

// NOTE applied to body
.meedan-bookmarklet-internal {
  #meedan_bookmarklet_preview,
  #edit-body,
  #edit-graphic-content,
  #edit-actions #edit-submit,
  #edit-title {
    display: none;
  }
}

// Bookmarklet
// NOTE: applied to html
#meedan_bookmarklet_html {
  height: auto;
  background: $white;
}

#meedan_bookmarklet {
  font-size: $small-font-size;
  overflow: hidden;
  position: relative;
  padding: 0;
  @include bookmarklet-forms;
  @include bookmarklet-login;
  @include bookmarklet-alerts;
  @include bookmarklet-step-one;
  @include bookmarklet-step-two;
}

#meedan_bookmarklet_close {
  position: absolute;
  #{opposite-position($from-direction)}: $gutter-width;
  top: 2px;
  z-index: 2;
}